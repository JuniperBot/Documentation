---
description: Описание всех доступных тегов шаблонного движка JuniperBot
---

# Теги

Теги — набор различных встроенных конструкций и операций над шаблоном. Они объявляются с помощью [островков кода](syntax/code-islands.md#kod) и определяют поведение шаблона.

## Команды

Теги команд выполняют какую-либо операцию, но ничего не печатают в результат шаблона.

### `set`

Команда `set` определяет операцию присваивания переменной в шаблоне. Она вычислит результат выражения и запишет его в переменную с указанным названием:

```csharp
{% set var = 2 + 3 %}
```

В примере выше результат вычисления `2 + 3` \(`5`\) будет записан в переменную `var`. 

`set` как команда не генерирует контент, она просто объявляет переменную или перезаписывает существующую переменную с этим именем.

### `do`

Команда `do` вычисляет указанное выражение, не печатая ничего в шаблон.

```csharp
{% do something.run() %}
```

Поскольку вывод команды пуст, она может быть полезна для тихого вызова каких-либо функций у объектов.

## Управление потоком

Шаблонный движок JuniperBot реализует базовые операторы контроля потока: условия и циклы

### `if/else` условия

Условные операторы — самые простые операторы управления потоком. Здесь поддерживаются последовательные конструкции с помощью оператора `elseif` и конструкция `else`.

```csharp
{% if (выражение) %}
// Блок вычисляется если выражение вычислено как true
{% elseif (другоеВыражение) %}
// Блок вычисляется если другое выражение вычислено как true
{% else %}
// Блок вычисляется если ни одно из указанных условий не было удовлетворено
{% endif %}
```

Обратите внимание, что конструкция `if` выведет содержимое только первого блока, которое удовлетворяет объявленным условиям \(то есть оценивается как `true`\). Способ, которым шаблонный движок оценивает выражение как `true`, будет объяснен далее в этом руководстве.

С точки зрения области видимости переменных, внутреннее содержимое блока `if` разделяет контекст с родительским контекстом. Это означает, что условия могут влиять на переменные во внешней области видимости.

```csharp
{% set variable = "раз" %}
{% if (true) %}
    {% set variable = "два" %}
{% endif %}
{{ variable }}
```

Предыдущий пример генерирует сообщение `два`, что иллюстрирует как область видимости в условиях разделяет контекст с родительской конструкцией.

### `for` циклы

Шаблонный движок JuniperBot поддерживает циклы над списками или картами.

```csharp
{# Пример цикла над списком #}
{% for item in list %}
// Контент с использованием переменной item
{% endfor %}

{# Пример цикла над картой #}
{% for key, value in map %}
// Контент с использованием переменных key и value карты
{% endfor %}
```

#### Переменная `loop`

Циклы `for` объявляют дополнительную переменную с идентификатором `loop`. Она предоставляет доступ к полезным свойствам внутри цикла:

| Свойство | Описание |
| :--- | :--- |
| `length` | Размер списка или карты |
| `index` | Номер текущей итерации, начинающийся с 1 |
| `index0` | Номер текущей итерации, начинающийся с 0 |
| `revindex` | Количество оставшихся итераций до достижения конца списка или карты, заканчивается на 1 |
| `revindex0` | Количество оставшихся итераций до достижения конца списка или карты, заканчивается на 0 |
| `first` | Свойство, равное `true` для самой первой итерации |
| `last` | Свойство, равное `false` для самой последней итерации |
| `parent` | Получение доступа к родительскому контексту |

```csharp
{% for item in [1, 2, 3] %}
    {% if (loop.first) %}
        Начало
    {% endif %}
{% endfor %}
```

Предыдущий пример распечатает слово `Начало` только один раз во время первой итерации.

Переменная `loop` привязана в контексту цикла `for`, это значит, что область видимости этой переменной ограничена лишь содержимым блока цикла. Если вне цикла объявлена переменная с названием `loop`, она не будет перезаписана, но доступ к ней можно будет получить только через родительский контекст, например:

```csharp
{% set loop = 1 %}
{% for item in [1, 2, 3] %}
    {% if (loop.first) %}
        {{ loop.parent.index }}
        {% set loop = 2 %}
    {% endif %}
{% endfor %}
{{ loop }}
```

Предыдущий пример распечатает `1 2`. Обратите внимание, что присваивание значения переменной `loop` внутри цикла не перезаписывает `loop` самого цикла. Эта переменная далее будет доступна уже вне цикла.

## Прочее

### `filter`

Конструкция фильтра — ещё одна возможность применять [функции](functions.md) к указанному контенту. Она использует содержимое указанного тела блока как аргумент для указанной функции.

```csharp
{% filter lower | capitalize -%}
HELLO WORLD
{%- endfilter %}
```

Предыдущий пример распечатает сообщение `Hello world`. Как мы видим, результатом фильтра является выполнение двух функций над телом блока. Сперва фильтр применяет функцию `lower` к содержимому `HELLO WORLD`, генерируя `hello world`, после этого применяет функцию `capitalize`, генерируя результирующее `Hello world`.

### `verbatim`

Этот тег полезен для избежания вычисления любого синтаксиса шаблонного движка, то есть оно не будет вычислять содержимое этого блока и распечатает его как есть.

```csharp
{% verbatim %}
{{ test }}
{% endverbatim %}
```

Предыдущий пример распечатает сообщение `{{ test }}`.

