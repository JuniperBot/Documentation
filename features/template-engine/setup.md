---
description: Краткая справка по настройке шаблонов сообщений JuniperBot
---

# Настройка шаблона

{% hint style="warning" %}
Если вы до сих пор не ознакомились с тем, как работает шаблонный движок, то прежде всего [сделайте это](./). Без этого дальше можете вообще не читать.
{% endhint %}

## Структура шаблона сообщения

Структура шаблона сообщения примерно везде одинаковая, она подробно описана в статье [Пользовательские команды — сообщение](../../cmd/custom/message.md#povedenie-i-nastroiki).

Шаблонный движок обрабатывает все поля шаблона сообщения, включая:

* Шаблон сообщения;
* Шаблон панели
* Автора панели;
* Наименования панели;
* Футера \(подвала\) панели;
* Поля панели \(в названии и значении\).

Данная страница описывает все возможные места, где используются шаблоны сообщений и какие данные в них передаются, которыми можно оперировать с помощью шаблонного движка и выводить их в сообщение. Это то, ради чего все затевалось.

## Данные шаблонов

### Глобальные переменные

Шаблонный движок поддерживает [глобальные переменные](tags.md#global), которые могут быть объявлены один раз и доступны во всех полях шаблона сообщения в порядке их генерации. Порядок генерации полей следующий:

1. Шаблон сообщения;
2. Шаблон панели;
3. Автор;
4. Наименование;
5. Футер \(подвал\);
6. Все поля панели по очереди.

Это значит, что глобальная переменная, объявленная в шаблоне наименования, будет доступна только в подвале и полях.

### Общие данные

Все шаблоны имеют несколько изначально определенных переменных:

| Переменная | Тип | Описание |
| :--- | :--- | :--- |
| `guild` | [Guild](types.md#guild) | Информация о сервере |
| `member` | [Member](types.md#member) | Информация об участнике, который спровоцировал генерацию данного шаблона сообщения |
| `channel` | [TextChannel](types.md#textchannel) | Информация о целевом канале, куда должно быть отправлено сообщение \(только если на сам сервер, а не в личку\) |
| `message` | [Message](types.md#message) | Информация о сообщении, которое могло спровоцировать отправку нового сообщения |

Эти переменные всегда включаются во все шаблоны сообщений. Далее отдельно будут описываться только те места, где есть какие-либо дополнительные данные или требуются пояснения к переменным из общих данных.

### Рейтинг участников <a id="ranking"></a>

В дополнение к общим переменным выше, в рейтинг участников передаются следующие данные:

| Переменная | Тип | Описание |
| :--- | :--- | :--- |
| `rolesAdded` | [Список](syntax/expressions.md#spiski)&lt;[Role](types.md#role)&gt; | Список выданных ролей-наград |
| `rolesRemoved` | [Список](syntax/expressions.md#spiski)&lt;[Role](types.md#role)&gt; | Список снятых ролей-наград |

### Автомодерация

Данные переменные используются в фильтрах автомодерации в уведомлениях о нарушении. Для каждого фильтра определен свой набор переменных, с которыми вы можете ознакомиться ниже.

#### Фильтр "Ссылки"

| Переменная | Тип | Описание |
| :--- | :--- | :--- |
| `infraction.linkUrl` | ​[Строка](syntax/expressions.md#primitivy) | Ссылка, попавшая под правила фильтра |
| `infraction.inviteCode` | ​[Строка](syntax/expressions.md#primitivy) | Код приглашения на сервер |
| `infraction.inviteUrl` | ​[Строка](syntax/expressions.md#primitivy) | Ссылка с приглашением на сервер в формате `discord.gg/<код>` |

#### Фильтр "Плохие слова"

| Переменная | Тип | Описание |
| :--- | :--- | :--- |
| `infraction.word` | ​[Строка](syntax/expressions.md#primitivy) | Обнаруженное плохое слово |

#### Фильтр "Повторяемый текст"

| Переменная | Тип | Описание |
| :--- | :--- | :--- |
| `infraction.count` | ​[Число](syntax/expressions.md#primitivy) | Количество одинаковых сообщений |

#### Фильтр "Caps Lock"

| Переменная | Тип | Описание |
| :--- | :--- | :--- |
| `infraction.percent` | ​[Число](syntax/expressions.md#primitivy) | Процент букв в верхнем регистре в сообщении |

#### Фильтр "Эмоции"

| Переменная | Тип | Описание |
| :--- | :--- | :--- |
| `infraction.count` | ​[Число](syntax/expressions.md#primitivy) | Количество обнаруженных эмоций в сообщении |

#### Фильтр "Упоминания"

| Переменная | Тип | Описание |
| :--- | :--- | :--- |
| `infraction.mentionType` | ​[Строка](syntax/expressions.md#primitivy) | Тип упоминаний, на которых сработал фильтр |
| `infraction.count` | ​[Число](syntax/expressions.md#primitivy) | Количество обнаруженных упоминаний этого типа |

### Пользовательские команды

Дополнительные переменные для пользовательских команд.

| Переменная | Тип | Описание |
| :--- | :--- | :--- |
| `content` | [Content](types.md#content) | Данные об аргументах, вызвавших пользовательскую команду. |

